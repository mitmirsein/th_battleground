<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theological Warfare Map: Justification</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Serif+KR:wght@400;700&display=swap');

        body {
            font-family: 'Noto Serif KR', serif;
            background-color: #0f172a;
            color: #e2e8f0;
        }

        .font-mono {
            font-family: 'JetBrains+Mono', monospace;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid #334155;
        }

        .axis-label-blue {
            color: #60a5fa;
            font-weight: bold;
        }

        .axis-label-red {
            color: #f87171;
            font-weight: bold;
        }

        .axis-label-green {
            color: #4ade80;
            font-weight: bold;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1e293b;
        }

        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        .layer-btn.active {
            border-left: 4px solid;
        }

        .step-pill {
            transition: all 0.3s;
        }

        .step-pill.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col bg-slate-900 overflow-x-hidden">

    <!-- í—¤ë” -->
    <header
        class="h-14 lg:h-16 border-b border-gray-700 flex items-center justify-between px-4 lg:px-6 bg-slate-900 z-20 shrink-0">
        <div class="flex items-center gap-2 lg:gap-3">
            <span class="text-xl lg:text-2xl">ğŸ›¡ï¸</span>
            <div>
                <h1 class="text-sm lg:text-lg font-bold text-gray-100 tracking-wider">WARFARE MAP: <span
                        class="text-yellow-500">JUSTIFICATION</span></h1>
                <p class="text-[10px] text-gray-400 font-mono hidden sm:block">Kerygma Press Analytical Engine v3.1</p>
            </div>
        </div>

        <div class="hidden md:flex flex-col items-center">
            <div id="mode-indicator" class="text-xs font-mono text-blue-400 mb-1">STORY MODE ACTIVE</div>
            <div class="flex gap-1">
                <div id="step-pills" class="flex gap-1"></div>
            </div>
        </div>

        <button id="mode-toggle"
            class="px-3 lg:px-4 py-1.5 lg:py-2 bg-slate-700 hover:bg-slate-600 rounded text-[10px] lg:text-xs font-mono border border-slate-500 transition">
            COMPARE
        </button>
    </header>

    <!-- ëª¨ë°”ì¼ íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="lg:hidden flex border-b border-gray-700 bg-slate-800">
        <button onclick="showMobileTab('chart')" id="tab-chart"
            class="flex-1 py-2 text-xs font-mono text-center border-b-2 border-blue-500 text-blue-400">ì°¨íŠ¸</button>
        <button onclick="showMobileTab('layers')" id="tab-layers"
            class="flex-1 py-2 text-xs font-mono text-center border-b-2 border-transparent text-gray-400">ë ˆì´ì–´</button>
        <button onclick="showMobileTab('story')" id="tab-story"
            class="flex-1 py-2 text-xs font-mono text-center border-b-2 border-transparent text-gray-400">ìŠ¤í† ë¦¬</button>
    </div>

    <main class="flex-1 flex flex-col lg:flex-row overflow-hidden">

        <!-- ì¢Œì¸¡: ë ˆì´ì–´ ì„ íƒ (ë°ìŠ¤í¬í†±) / ëª¨ë°”ì¼ íƒ­ -->
        <aside id="panel-layers"
            class="hidden lg:flex w-full lg:w-64 bg-slate-900 border-r border-gray-700 flex-col z-10 lg:max-h-full overflow-y-auto">
            <div class="p-4 border-b border-gray-800 shrink-0">
                <h2 class="text-xs font-mono text-gray-500 uppercase mb-2">Theologian Layers</h2>
                <div class="text-[10px] text-gray-400">Select to compare specific positions.</div>
            </div>
            <div id="layer-list" class="flex-1 overflow-y-auto p-2 space-y-1"></div>
        </aside>

        <!-- ì¤‘ì•™: ì°¨íŠ¸ -->
        <section id="panel-chart"
            class="flex-1 relative flex items-center justify-center bg-slate-800/50 p-4 min-h-[50vh] lg:min-h-0">
            <div class="absolute inset-0 opacity-10 pointer-events-none"
                style="background-image: linear-gradient(#334155 1px, transparent 1px), linear-gradient(90deg, #334155 1px, transparent 1px); background-size: 20px 20px;">
            </div>

            <div class="relative w-full max-w-lg lg:max-w-3xl aspect-square p-2 lg:p-4">
                <canvas id="warfareChart"></canvas>
            </div>

            <div
                class="absolute bottom-2 left-2 lg:bottom-4 lg:left-4 p-2 lg:p-3 glass-panel rounded-lg text-[10px] lg:text-xs font-mono space-y-1">
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 rounded-full bg-blue-400"></div><span>OBJECTIVE</span>
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 rounded-full bg-red-400"></div><span>SUBJECTIVE</span>
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 rounded-full bg-green-400"></div><span>TRANSCENDENT</span>
                </div>
            </div>
        </section>

        <!-- ìš°ì¸¡: ìŠ¤í† ë¦¬ + ì¸ì‚¬ì´íŠ¸ -->
        <aside id="panel-story"
            class="hidden lg:flex w-full lg:w-96 bg-slate-900 border-l border-gray-700 flex-col z-10 max-h-[50vh] lg:max-h-full">

            <div class="flex-[7] flex flex-col border-b border-gray-700 overflow-hidden">
                <div
                    class="p-3 lg:p-4 border-b border-gray-800 bg-slate-800/50 flex justify-between items-center shrink-0">
                    <h2 class="text-xs lg:text-sm font-bold text-yellow-500 flex items-center gap-2">
                        <span id="info-icon">ğŸ“–</span> <span id="info-title">SITUATION REPORT</span>
                    </h2>
                </div>
                <div id="info-content"
                    class="p-4 lg:p-5 overflow-y-auto text-sm leading-relaxed text-gray-300 space-y-4 flex-1"></div>
            </div>

            <div class="flex-[3] bg-slate-950 flex flex-col">
                <div class="p-2 lg:p-3 border-b border-gray-800 flex justify-between items-center shrink-0">
                    <span class="text-[10px] lg:text-xs font-mono text-cyan-400">AI TACTICAL INSIGHT</span>
                    <div id="story-controls" class="flex gap-2">
                        <button id="prev-btn"
                            class="px-2 lg:px-3 py-1 bg-slate-800 hover:bg-slate-700 rounded text-xs">â—€</button>
                        <button id="next-btn"
                            class="px-2 lg:px-3 py-1 bg-blue-900 hover:bg-blue-800 text-blue-100 rounded text-xs">â–¶</button>
                    </div>
                </div>
                <div id="ai-insight"
                    class="p-3 lg:p-4 text-xs font-mono text-cyan-100/80 leading-5 overflow-y-auto flex-1"></div>
            </div>
        </aside>

    </main>

    <script>
        // ëª¨ë°”ì¼ íƒ­ ì „í™˜
        function showMobileTab(tab) {
            const tabs = ['chart', 'layers', 'story'];
            tabs.forEach(t => {
                const panel = document.getElementById('panel-' + t);
                const tabBtn = document.getElementById('tab-' + t);
                if (t === tab) {
                    panel.classList.remove('hidden');
                    panel.classList.add('flex');
                    tabBtn.classList.add('border-blue-500', 'text-blue-400');
                    tabBtn.classList.remove('border-transparent', 'text-gray-400');
                } else {
                    if (window.innerWidth < 1024) {
                        panel.classList.add('hidden');
                        panel.classList.remove('flex');
                    }
                    tabBtn.classList.remove('border-blue-500', 'text-blue-400');
                    tabBtn.classList.add('border-transparent', 'text-gray-400');
                }
            });
        }

        // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ë°ìŠ¤í¬í†± ë ˆì´ì•„ì›ƒ ë³µì›
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024) {
                document.getElementById('panel-layers').classList.remove('hidden');
                document.getElementById('panel-layers').classList.add('flex');
                document.getElementById('panel-chart').classList.remove('hidden');
                document.getElementById('panel-chart').classList.add('flex');
                document.getElementById('panel-story').classList.remove('hidden');
                document.getElementById('panel-story').classList.add('flex');
            }
        });

        // --- Data Definition ---
        const axes = [
            'ë²•ì •ì  ì„ ì–¸ (Forensic)', // Blue
            'ì˜ì˜ ì „ê°€ (Imputation)', // Blue
            'ì˜¤ì§ ë¯¿ìŒ (Sola Fide)',  // Blue
            'êµ¬ì›ì˜ í™•ì‹  (Assurance)', // Red
            'ìˆ˜ë™ì„± (Passivity)',     // Red
            'ì™¸ë¶€ì„± (Extra Nos)',     // Green
            'ì¢…ë§ë¡  (Eschatology)'    // Green
        ];

        const theologians = {
            'augustine': {
                id: 'augustine', name: 'ì•„ìš°êµ¬ìŠ¤í‹°ëˆ„ìŠ¤', era: 'Patristic', color: 'rgba(234, 179, 8, 1)', fill: 'rgba(234, 179, 8, 0.2)',
                data: [2, 2, 3, 3, 6, 3, 4],
                desc: "ì„œêµ¬ ì‹ í•™ì˜ ê¸°ì´ˆ. ê·¸ëŠ” ì¹­ì˜ë¥¼ 'ì˜ë¡­ê²Œ ë¨(making righteous)'ì˜ ì‹¤ì œì  ë³€í™” ê³¼ì •ìœ¼ë¡œ ë³´ì•˜ë‹¤. í•˜ë‚˜ë‹˜ì˜ ì€í˜œê°€ ì£¼ì…(Infusion)ë˜ì–´ ì¸ê°„ì˜ ë³¸ì„±ì„ ì¹˜ë£Œí•˜ê³ , ì˜ì§€ê°€ íšŒë³µë˜ì–´ ì‚¬ë‘ìœ¼ë¡œ ì—­ì‚¬í•˜ëŠ” ë¯¿ìŒì„ í†µí•´ êµ¬ì›ì— ì´ë¥¸ë‹¤."
            },
            'aquinas': {
                id: 'aquinas', name: 'í† ë§ˆìŠ¤ ì•„í€´ë‚˜ìŠ¤', era: 'Medieval', color: 'rgba(217, 119, 6, 1)', fill: 'rgba(217, 119, 6, 0.2)',
                data: [1, 1, 2, 2, 4, 2, 3],
                desc: "ì¤‘ì„¸ ìŠ¤ì½œë¼ ì‹ í•™ì˜ ì •ì . ì€í˜œëŠ” ì¸ê°„ ë³¸ì„±ì„ íŒŒê´´í•˜ì§€ ì•Šê³  ì™„ì„±í•œë‹¤. 'ì‚¬ë‘ìœ¼ë¡œ í˜•ì„±ëœ ë¯¿ìŒ(Fides caritate formata)'ì„ ì£¼ì¥í•˜ë©°, ì¹­ì˜ëŠ” ì£„ ì‚¬í•¨ê³¼ ë‚´ì  ì‡„ì‹ ì„ í¬í•¨í•˜ëŠ” ê³¼ì •ì´ë‹¤. ê³µë¡œ ê°œë…ì„ ì²´ê³„í™”í–ˆë‹¤."
            },
            'luther': {
                id: 'luther', name: 'ë§ˆë¥´í‹´ ë£¨í„°', era: 'Reformation', color: 'rgba(239, 68, 68, 1)', fill: 'rgba(239, 68, 68, 0.2)',
                data: [10, 10, 10, 9, 10, 10, 8],
                desc: "ì½”í˜ë¥´ë‹ˆì¿ ìŠ¤ì  ì „í™˜. ì¹­ì˜ëŠ” ë²•ì •ì  ì„ ì–¸ì´ë©°, ê·¸ë¦¬ìŠ¤ë„ì˜ 'ë‚¯ì„  ì˜(Alien Righteousness)'ê°€ ì „ê°€ë˜ëŠ” ê²ƒì´ë‹¤. ìš°ë¦¬ ì•ˆì˜ ê·¸ ì–´ë–¤ ë³€í™”ë„ ì¹­ì˜ì˜ ê·¼ê±°ê°€ ë  ìˆ˜ ì—†ë‹¤. 'ë™ì‹œì— ì˜ì¸ì´ì ì£„ì¸(Simul justus et peccator)'."
            },
            'trent': {
                id: 'trent', name: 'íŠ¸ë ŒíŠ¸ ê³µì˜íšŒ', era: 'Counter-Ref', color: 'rgba(168, 85, 247, 1)', fill: 'rgba(168, 85, 247, 0.2)',
                data: [1, 1, 1, 2, 3, 2, 2],
                desc: "ê°€í†¨ë¦­ì˜ ê³µì‹ ë°˜ê²©. 'ì˜¤ì§ ë¯¿ìŒ'ì„ ì €ì£¼(Anathema)í•˜ê³ , ì¹­ì˜ê°€ ì£„ ì‚¬í•¨ë¿ ì•„ë‹ˆë¼ ì¸ê°„ ë‚´ë©´ì˜ ì„±í™”ì™€ ì‡„ì‹ ì„ì„ ì¬í™•ì¸í–ˆë‹¤. ì „ê°€ëœ ì˜ê°€ ì•„ë‹ˆë¼ ì£¼ì…ëœ ì€í˜œê°€ ì¹­ì˜ì˜ ìœ ì¼í•œ í˜•ìƒì  ì›ì¸ì´ë‹¤."
            },
            'calvin': {
                id: 'calvin', name: 'ì¡´ ì¹¼ë±…', era: 'Reformation', color: 'rgba(249, 115, 22, 1)', fill: 'rgba(249, 115, 22, 0.2)',
                data: [9, 9, 9, 9, 9, 9, 7],
                desc: "ì´ì¤‘ ì€í˜œ(Duplex Gratia). ê·¸ë¦¬ìŠ¤ë„ì™€ì˜ ì‹ ë¹„ì  ì—°í•©ì„ í†µí•´ ì¹­ì˜ì™€ ì„±í™”ë¼ëŠ” ë‘ ê°€ì§€ ì€í˜œë¥¼ ë™ì‹œì— ë°›ëŠ”ë‹¤. ë‘˜ì€ êµ¬ë³„ë˜ì§€ë§Œ ë¶„ë¦¬ë  ìˆ˜ ì—†ë‹¤. ì„±ë ¹ì˜ ë‚´ì  ì¦ê±°ë¥¼ í†µí•œ í™•ì‹ ì„ ê°•ì¡°í–ˆë‹¤."
            },
            'wesley': {
                id: 'wesley', name: 'ì¡´ ì›¨ìŠ¬ë¦¬', era: 'Modern', color: 'rgba(59, 130, 246, 1)', fill: 'rgba(59, 130, 246, 0.2)',
                data: [6, 4, 6, 9, 3, 5, 5],
                desc: "ë³µìŒì£¼ì˜ì  ì¢…í•©. ì¢…êµê°œí˜ì˜ ì¹­ì˜ë¡ (ë¯¿ìŒìœ¼ë¡œ ë§ë¯¸ì•”ëŠ” êµ¬ì›)ì„ ìˆ˜ìš©í•˜ë˜, ì„±í™”ì™€ ì™„ì „(Christian Perfection)ì„ ê°•ë ¥íˆ ì£¼ì¥í–ˆë‹¤. ì„ í–‰ ì€ì´(Prevenient Grace)ì„ í†µí•œ ì¸ê°„ì˜ ì‘ë‹µ ê°€ëŠ¥ì„±ì„ ì—´ì–´ë‘ì—ˆë‹¤."
            },
            'schleiermacher': {
                id: 'schleiermacher', name: 'ìŠë¼ì´ì–´ë§ˆí—ˆ', era: 'Modern', color: 'rgba(14, 165, 233, 1)', fill: 'rgba(14, 165, 233, 0.2)',
                data: [2, 1, 3, 8, 4, 2, 2],
                desc: "ê·¼ëŒ€ ì‹ í•™ì˜ ì•„ë²„ì§€. êµë¦¬ë¥¼ ê°ê´€ì  ì‚¬ì‹¤ì—ì„œ ì£¼ê´€ì  ì¢…êµ ì˜ì‹(ì ˆëŒ€ì˜ì¡´ê°ì •)ì˜ í‘œí˜„ìœ¼ë¡œ ì „í™˜í–ˆë‹¤. ì¹­ì˜ëŠ” ê°œì¸ì´ ê³µë™ì²´ ì•ˆì—ì„œ ê·¸ë¦¬ìŠ¤ë„ì˜ êµ¬ì†ì  ì˜ì‹ì„ ê³µìœ í•˜ë©° í•˜ë‚˜ë‹˜ê³¼ í™”í•´ëœ ìƒíƒœë¥¼ ëŠë¼ëŠ” ê²ƒì´ë‹¤."
            },
            'barth': {
                id: 'barth', name: 'ì¹¼ ë°”ë¥´íŠ¸', era: 'Modern', color: 'rgba(20, 184, 166, 1)', fill: 'rgba(20, 184, 166, 0.2)',
                data: [9, 9, 8, 9, 10, 10, 9],
                desc: "ì‹ ì •í†µì£¼ì˜ì˜ ê±°í¬. ì¸ê°„ì˜ ì¢…êµì„±ì„ ë¶€ì •í•˜ê³ , ì˜¤ì§ ìœ„ë¡œë¶€í„° ì˜¤ëŠ” í•˜ë‚˜ë‹˜ì˜ ë§ì”€ê³¼ ê²°ë‹¨ì„ ê°•ì¡°í–ˆë‹¤. ì¹­ì˜ëŠ” ì˜ì› ì†ì—ì„œ ì´ë¯¸ ì´ë£¨ì–´ì§„ ê·¸ë¦¬ìŠ¤ë„ì˜ ê°ê´€ì  í™”í•´ ì‚¬ê±´ì´ë‹¤."
            },
            'bultmann': {
                id: 'bultmann', name: 'ë£¨ëŒí”„ ë¶ˆíŠ¸ë§Œ', era: 'Modern', color: 'rgba(99, 102, 241, 1)', fill: 'rgba(99, 102, 241, 0.2)',
                data: [3, 2, 9, 5, 8, 4, 9],
                desc: "ì‹¤ì¡´ë¡ ì  í•´ì„. ì¹­ì˜ëŠ” ê°ê´€ì  êµë¦¬ê°€ ì•„ë‹ˆë¼, ë§¤ ìˆœê°„ ê²°ë‹¨ì„ í†µí•´ ìê¸° ì˜ì¡´ì„ ë²„ë¦¬ê³  í•˜ë‚˜ë‹˜ì„ ì‹ ë¢°í•˜ëŠ” ì‹¤ì¡´ì  ì‚¬ê±´ì´ë‹¤. ì—­ì‚¬ì  ì‚¬ì‹¤ë³´ë‹¤ 'ì§€ê¸ˆ ì—¬ê¸°'ì—ì„œì˜ ë§ì”€ ì„ í¬(Kerygma)ê°€ ì¤‘ìš”í•˜ë‹¤."
            },
            'wright': {
                id: 'wright', name: 'í†° ë¼ì´íŠ¸', era: 'Contemporary', color: 'rgba(34, 197, 94, 1)', fill: 'rgba(34, 197, 94, 0.2)',
                data: [7, 3, 7, 7, 6, 6, 10],
                desc: "ë°”ìš¸ì˜ ìƒˆ ê´€ì (NPP). ì¹­ì˜ëŠ” 'ëˆ„ê°€ í•˜ë‚˜ë‹˜ì˜ ì–¸ì•½ ë°±ì„±ì¸ê°€'ë¥¼ ì„ ì–¸í•˜ëŠ” ë©¤ë²„ì‹­ì˜ ë¬¸ì œë‹¤. 'ë²•ì •ì ' ì˜ë¯¸ë¥¼ ì¸ì •í•˜ë‚˜, 'ì˜ì˜ ì „ê°€' êµë¦¬ë¥¼ ë¹„íŒí•˜ê³  ì¢…ë§ë¡ ì , ì–¸ì•½ì  ë§¥ë½ì„ ê°•ì¡°í•œë‹¤."
            }
        };

        const storySteps = [
            {
                title: "ì„œë§‰: ì¹­ì˜ì˜ ì „ì¥",
                activeLayers: [],
                text: "ì¹­ì˜(Justification). 'ì£„ì¸ì´ ì–´ë–»ê²Œ ê±°ë£©í•˜ì‹  í•˜ë‚˜ë‹˜ ì•ì— ì„¤ ìˆ˜ ìˆëŠ”ê°€?' ì´ ì§ˆë¬¸ì€ ê¸°ë…êµ ì—­ì‚¬ìƒ ê°€ì¥ ì¹˜ì—´í•œ ì‹ í•™ì  ì „ìŸì„ ì´‰ë°œí–ˆìŠµë‹ˆë‹¤. 7ê°€ì§€ í•µì‹¬ ì²™ë„ë¥¼ í†µí•´ ì´ ê±°ëŒ€í•œ ë“œë¼ë§ˆë¥¼ ì¶”ì í•©ë‹ˆë‹¤. íŒŒë€ìƒ‰ ì¶•ì€ ê°ê´€ì  ë²•ì •ì„±, ë¶‰ì€ìƒ‰ ì¶•ì€ ì£¼ê´€ì  ì²´í—˜, ì´ˆë¡ìƒ‰ ì¶•ì€ ì´ˆì›”ì  ì‹ ë¹„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.",
                insight: "ëª¨ë“  ë ˆì´ì–´ê°€ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ê° ì¶•ì˜ ì˜ë¯¸ë¥¼ í™•ì¸í•˜ê³  ì—­ì‚¬ì˜ ì‹œì‘ì„ ì¤€ë¹„í•˜ì‹­ì‹œì˜¤."
            },
            {
                title: "ê³ ëŒ€ì˜ ì¢…í•©: ì•„ìš°êµ¬ìŠ¤í‹°ëˆ„ìŠ¤",
                activeLayers: ['augustine'],
                text: "ì„œë°© ì‹ í•™ì˜ ê±°ì¸ ì•„ìš°êµ¬ìŠ¤í‹°ëˆ„ìŠ¤ëŠ” ì¹­ì˜ë¥¼ 'ì˜ì¸(making righteous)'ì˜ ê³¼ì •ìœ¼ë¡œ ì´í•´í–ˆìŠµë‹ˆë‹¤. ì¸ê°„ì€ ì›ì£„ë¡œ ë³‘ë“¤ì—ˆê¸°ì—, ì€í˜œê°€ ì£¼ì…(Infusion)ë˜ì–´ì•¼ë§Œ ì¹˜ë£Œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë²•ì •ì  ì„ ì–¸ë³´ë‹¤ëŠ” ì‹¤ì§ˆì ì¸ ë‚´ì  ë³€í™”ê°€ í•µì‹¬ì…ë‹ˆë‹¤.",
                insight: "ë‚®ì€ ë²•ì •ì„±(1ì¶•)ê³¼ ë†’ì€ ì£¼ê´€ì  ë³€í™”ì˜ ê°€ëŠ¥ì„±ì´ ë³´ì…ë‹ˆë‹¤. ì´ê²ƒì´ 1000ë…„ê°„ ì„œêµ¬ ì‹ í•™ì˜ í‘œì¤€ì´ ë©ë‹ˆë‹¤."
            },
            {
                title: "ì¤‘ì„¸ì˜ ì²´ê³„í™”: ì•„í€´ë‚˜ìŠ¤",
                activeLayers: ['augustine', 'aquinas'],
                text: "í† ë§ˆìŠ¤ ì•„í€´ë‚˜ìŠ¤ëŠ” ì•„ë¦¬ìŠ¤í† í…”ë ˆìŠ¤ ì² í•™ì„ ë„ì…í•˜ì—¬ ì´ë¥¼ ì²´ê³„í™”í•©ë‹ˆë‹¤. 'ì€í˜œëŠ” ìì—°ì„ íŒŒê´´í•˜ì§€ ì•Šê³  ì™„ì„±í•œë‹¤.' ë¯¿ìŒì€ ì‚¬ë‘ìœ¼ë¡œ í˜•ì„±(Formata)ë  ë•Œ ë¹„ë¡œì†Œ êµ¬ì›ì˜ íš¨ë ¥ì„ ê°€ì§‘ë‹ˆë‹¤. ê³µë¡œì™€ ì€í˜œì˜ ì •êµí•œ ì¡°í™”ê°€ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.",
                insight: "ë‘ í•™ìì˜ ë ˆì´ì–´ê°€ ê±°ì˜ ê²¹ì¹©ë‹ˆë‹¤. ì¤‘ì„¸ ê°€í†¨ë¦­ ì‹ í•™ì˜ ê²¬ê³ í•œ ì—°ì†ì„±ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
            },
            {
                title: "ì¢…êµê°œí˜ì˜ í­ë°œ: ë£¨í„°",
                activeLayers: ['aquinas', 'luther'],
                text: "ë§ˆë¥´í‹´ ë£¨í„°ì˜ 'íƒ‘ì˜ ì²´í—˜'ì€ ëª¨ë“  ê²ƒì„ ë’¤ì§‘ì—ˆìŠµë‹ˆë‹¤. 'í•˜ë‚˜ë‹˜ì˜ ì˜'ëŠ” ë‚´ ì•ˆì˜ ìì§ˆì´ ì•„ë‹ˆë¼, ì™¸ë¶€ì—ì„œ ì£¼ì–´ì§€ëŠ” ì„ ë¬¼ì…ë‹ˆë‹¤. ë²•ì •ì  ì„ ì–¸, ì˜¤ì§ ë¯¿ìŒ, ë‚¯ì„  ì˜(Alien Righteousness). ì°¨íŠ¸ì˜ íŒŒë€ìƒ‰(ê°ê´€)ê³¼ ì´ˆë¡ìƒ‰(ì´ˆì›”) ì¶•ì´ ê¸‰ê²©íˆ íŒ½ì°½í•©ë‹ˆë‹¤.",
                insight: "ê·¹ì ì¸ ëŒ€ì¡°ë¥¼ ë³´ì‹­ì‹œì˜¤. ì•„í€´ë‚˜ìŠ¤ì˜ ë‚´ì¬ì  ì¶•ì†Œì™€ ë£¨í„°ì˜ ì™¸ì  íŒ½ì°½ì€ ì‹ í•™ì  ì§€ê° ë³€ë™ì„ ì‹œê°ì ìœ¼ë¡œ ì¦ëª…í•©ë‹ˆë‹¤."
            },
            {
                title: "ì œêµ­(ê°€í†¨ë¦­)ì˜ ì—­ìŠµ: íŠ¸ë ŒíŠ¸",
                activeLayers: ['luther', 'trent'],
                text: "íŠ¸ë ŒíŠ¸ ê³µì˜íšŒëŠ” ë£¨í„°ì˜ 'ì˜¤ì§ ë¯¿ìŒ'ì„ ì €ì£¼í•˜ë©° ë°˜ê²©í•©ë‹ˆë‹¤. ê·¸ë“¤ì€ ì¹­ì˜ê°€ ì£„ ì‚¬í•¨ë¿ ì•„ë‹ˆë¼ ì„±í™”ì™€ ì‡„ì‹ ì„ í¬í•¨í•œë‹¤ê³  ëª» ë°•ì•˜ìŠµë‹ˆë‹¤. ì „ê°€ê°€ ì•„ë‹Œ ì£¼ì…. ì°¨íŠ¸ëŠ” ë‹¤ì‹œ ì¤‘ì‹¬ìœ¼ë¡œ ìˆ˜ì¶•í•˜ë©° ë£¨í„°ì™€ ì •ë©´ìœ¼ë¡œ ëŒ€ì¹˜í•©ë‹ˆë‹¤.",
                insight: "ê°€ì¥ ë‚ ì¹´ë¡œìš´ ëŒ€ë¦½ê°ì…ë‹ˆë‹¤. 1, 2, 3ë²ˆ ì¶•(ë²•ì •, ì „ê°€, ë¯¿ìŒ)ì—ì„œ ë£¨í„°ì™€ íŠ¸ë ŒíŠ¸ëŠ” ì–‘ê·¹ë‹¨ì— ìœ„ì¹˜í•©ë‹ˆë‹¤."
            },
            {
                title: "ê°œí˜ì˜ ì •êµí™”: ì¹¼ë±…",
                activeLayers: ['luther', 'calvin'],
                text: "ì¹¼ë±…ì€ ë£¨í„°ì˜ í†µì°°ì„ ì´ì–´ë°›ìœ¼ë©´ì„œë„ 'ê·¸ë¦¬ìŠ¤ë„ì™€ì˜ ì—°í•©'ìœ¼ë¡œ ì¢…í•©í•©ë‹ˆë‹¤. ì¹­ì˜ì™€ ì„±í™”ëŠ” êµ¬ë³„ë˜ì§€ë§Œ ë¶„ë¦¬ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤(ì´ì¤‘ ì€í˜œ). ë£¨í„°ë³´ë‹¤ ê· í˜• ì¡íŒ í˜•íƒœë¥¼ ë³´ì´ë‚˜, ì—¬ì „íˆ ë²•ì •ì  í† ëŒ€ ìœ„ì— ìˆìŠµë‹ˆë‹¤.",
                insight: "ë£¨í„°ì™€ ìœ ì‚¬í•œ í˜•ìƒì´ì§€ë§Œ, ì„±í™”ì˜ í•„ì—°ì„±ì„ ê°•ì¡°í•˜ë©° ì•½ê°„ì˜ ë¯¸ì„¸ ì¡°ì •ì´ ì´ë£¨ì–´ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
            },
            {
                title: "ëœ¨ê±°ìš´ ë³µìŒì£¼ì˜: ì›¨ìŠ¬ë¦¬",
                activeLayers: ['calvin', 'wesley'],
                text: "ì¡´ ì›¨ìŠ¬ë¦¬ëŠ” ì¢…êµê°œí˜ì˜ 'ë¯¿ìŒ'ì— 'ê±°ë£©í•œ ì‚¶'ì„ ë‹¤ì‹œ ì—°ê²°í•©ë‹ˆë‹¤. ê·¸ëŠ” ì„±í™”ë¥¼ ê°•ì¡°í•˜ë‹¤ ëª»í•´ 'ì™„ì „'ì„ ë…¼í–ˆìŠµë‹ˆë‹¤. ì„ í–‰ ì€ì´ì„ í†µí•œ ì¸ê°„ì˜ ì±…ì„ ìˆëŠ” ì‘ë‹µì„ ê°•ì¡°í•˜ì—¬ ìˆ˜ë™ì„± ì¶•(5ë²ˆ)ì´ ë‚®ì•„ì§‘ë‹ˆë‹¤.",
                insight: "ì¹¼ë±…ì˜ ë†’ì€ ìˆ˜ë™ì„±(Monergism)ê³¼ ëŒ€ë¹„ë˜ëŠ” ì›¨ìŠ¬ë¦¬ì˜ ì‹ ì¸í˜‘ë ¥ì (Synergistic) íŒ¨í„´ì´ 5ë²ˆ ì¶•ì—ì„œ ë“œëŸ¬ë‚©ë‹ˆë‹¤."
            },
            {
                title: "ì£¼ê´€ì  ì „í™˜: ìŠë¼ì´ì–´ë§ˆí—ˆ",
                activeLayers: ['wesley', 'schleiermacher'],
                text: "ê³„ëª½ì£¼ì˜ ì´í›„, ìŠë¼ì´ì–´ë§ˆí—ˆëŠ” ì‹ í•™ì˜ ê¸°ì´ˆë¥¼ 'ì ˆëŒ€ì˜ì¡´ê°ì •'ìœ¼ë¡œ ì˜®ê¹ë‹ˆë‹¤. êµë¦¬ëŠ” ê°ê´€ì  ì‚¬ì‹¤ì´ ì•„ë‹ˆë¼ ì‹ ì•™ ê³µë™ì²´ì˜ ê²½í—˜ì— ëŒ€í•œ ê¸°ìˆ ì´ ë©ë‹ˆë‹¤. ê°ê´€ì„± ì¶•(1-3)ì´ ë¶•ê´´ë˜ê³  ì£¼ê´€ì„±(4)ì´ ê°•ì¡°ë©ë‹ˆë‹¤.",
                insight: "ê°ê´€ì  ì§„ë¦¬(íŒŒë€ìƒ‰)ê°€ ì‚¬ë¼ì§€ê³  ë‚´ë©´ì˜ ê°ì •ìœ¼ë¡œ ì ë¦¬ëŠ” ê·¼ëŒ€ ì‹ í•™ì˜ íŠ¹ì§•ì ì¸ 'ì°Œê·¸ëŸ¬ì§„' ì°¨íŠ¸ì…ë‹ˆë‹¤."
            },
            {
                title: "ë§ì”€ì˜ ê·€í™˜: ë°”ë¥´íŠ¸",
                activeLayers: ['schleiermacher', 'barth'],
                text: "ììœ ì£¼ì˜ ì‹ í•™ì˜ ë†€ì´í„°ì— ë°”ë¥´íŠ¸ê°€ í­íƒ„ì„ ë˜ì§‘ë‹ˆë‹¤. 'ì•„ë‹ˆì˜¤(Nein)!' ê·¸ëŠ” ì¸ê°„ì˜ ì¢…êµì  ì²´í—˜ì„ ë¶€ì •í•˜ê³ , í•˜ë‚˜ë‹˜ì˜ ìˆ˜ì§ì  ë§ì”€ì„ ë‹¤ì‹œ ì„¸ì›ë‹ˆë‹¤. ë£¨í„°ì˜ í˜•ìƒì´ í˜„ëŒ€ì ìœ¼ë¡œ, ë”ìš± ê¸‰ì§„ì ìœ¼ë¡œ ë¶€í™œí•©ë‹ˆë‹¤.",
                insight: "ìŠë¼ì´ì–´ë§ˆí—ˆì™€ ì •ë°˜ëŒ€ì…ë‹ˆë‹¤. ë°”ë¥´íŠ¸ì˜ ì°¨íŠ¸ëŠ” 'ì™¸ë¶€ì„±(6ë²ˆ)'ê³¼ 'ë²•ì •ì„±(1ë²ˆ)'ì—ì„œ ê·¹í•œì˜ ê°’ì„ ì°ìŠµë‹ˆë‹¤."
            },
            {
                title: "ì‹¤ì¡´ì  ê²°ë‹¨: ë¶ˆíŠ¸ë§Œ",
                activeLayers: ['barth', 'bultmann'],
                text: "ë¶ˆíŠ¸ë§Œì€ ë°”ë¥´íŠ¸ì™€ ë™ì§€ì˜€ìœ¼ë‚˜ ê¸¸ì„ ë‹¬ë¦¬í•©ë‹ˆë‹¤. ê·¸ì—ê²Œ ì¹­ì˜ëŠ” ê°ê´€ì  ì‚¬ì‹¤ì´ ì•„ë‹ˆë¼, ë§¤ ìˆœê°„ ë‚˜ì˜ ì˜› ìì•„ë¥¼ ë²„ë¦¬ê³  í•˜ë‚˜ë‹˜ì„ ì„ íƒí•˜ëŠ” ì‹¤ì¡´ì  ê²°ë‹¨ì…ë‹ˆë‹¤. ì¢…ë§ë¡ (7ë²ˆ)ì€ ë¯¸ë˜ê°€ ì•„ë‹Œ 'í˜„ì¬ì˜ ìˆœê°„'ì´ ë©ë‹ˆë‹¤.",
                insight: "ì˜¤ì§ ë¯¿ìŒ(3ë²ˆ)ì€ ë†’ì§€ë§Œ, ë²•ì •ì  ê°ê´€ì„±(1,2ë²ˆ)ì€ ë‚®ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ì‹¤ì¡´ì£¼ì˜ì  í•´ì„ì˜ ê¸°í˜•ì ì¸ íŠ¹ì§•ì…ë‹ˆë‹¤."
            },
            {
                title: "í˜„ëŒ€ì˜ ì „ì„ : í†° ë¼ì´íŠ¸ (NPP)",
                activeLayers: ['luther', 'wright'],
                text: "í˜„ëŒ€ ì‹ í•™ê³„ì˜ ëœ¨ê±°ìš´ ê°ì, 'ë°”ìš¸ì˜ ìƒˆ ê´€ì '. í†° ë¼ì´íŠ¸ëŠ” ì¹­ì˜ë¥¼ êµ¬ì›ë¡ ì´ ì•„ë‹Œ êµíšŒë¡ (ì–¸ì•½ì˜ ë©¤ë²„ì‹­)ìœ¼ë¡œ ì¬í•´ì„í•©ë‹ˆë‹¤. ì „í†µì  ê°œí˜ì£¼ì˜ìë“¤ì€ ì´ë¥¼ 'ì „ê°€ êµë¦¬ì˜ í¬ê¸°'ë¼ë©° ë¹„íŒí•©ë‹ˆë‹¤.",
                insight: "ë£¨í„°ì™€ ë¹„êµí•´ ë³´ì‹­ì‹œì˜¤. 2ë²ˆ(ì „ê°€) ì¶•ì´ í‘¹ êº¼ì ¸ìˆê³ , 7ë²ˆ(ì¢…ë§ë¡ /ìƒˆì°½ì¡°)ì´ í™•ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ í˜„ëŒ€ì˜ ê°ˆë“± ì§€ì ì…ë‹ˆë‹¤."
            }
        ];

        // --- Application Logic ---
        let currentStep = 0;
        let isStoryMode = true;
        let chartInstance = null;
        let activeLayerIds = new Set();

        function initChart() {
            const ctx = document.getElementById('warfareChart').getContext('2d');

            chartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: axes,
                    datasets: []
                },
                options: {
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            pointLabels: {
                                font: { size: 11, family: 'Noto Serif KR', weight: 'bold' },
                                color: (ctx) => {
                                    const index = ctx.index;
                                    if (index <= 2) return '#60a5fa'; // Blue
                                    if (index <= 4) return '#f87171'; // Red
                                    return '#4ade80'; // Green
                                }
                            },
                            suggestedMin: 0,
                            suggestedMax: 10,
                            ticks: { display: false, stepSize: 2 }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            titleFont: { family: 'Noto Serif KR' },
                            bodyFont: { family: 'JetBrains Mono' },
                            padding: 10,
                            borderColor: '#334155',
                            borderWidth: 1
                        }
                    },
                    maintainAspectRatio: false,
                    animation: { duration: 1000, easing: 'easeOutQuart' }
                }
            });
        }

        function updateChart() {
            const datasets = Array.from(activeLayerIds).map(id => {
                const t = theologians[id];
                return {
                    label: t.name,
                    data: t.data,
                    backgroundColor: t.fill,
                    borderColor: t.color,
                    borderWidth: 2,
                    pointBackgroundColor: t.color,
                    pointRadius: 3
                };
            });
            chartInstance.data.datasets = datasets;
            chartInstance.update();
        }

        function renderLayerList() {
            const list = document.getElementById('layer-list');
            list.innerHTML = '';

            // Group by era for better UX
            const eras = { 'Patristic': 'ê³ ëŒ€', 'Medieval': 'ì¤‘ì„¸', 'Reformation': 'ì¢…êµê°œí˜', 'Counter-Ref': 'ë°˜ì¢…êµê°œí˜', 'Modern': 'ê·¼ëŒ€', 'Contemporary': 'í˜„ëŒ€' };

            let currentEra = '';

            Object.values(theologians).forEach(t => {
                if (t.era !== currentEra) {
                    const eraHeader = document.createElement('div');
                    eraHeader.className = 'text-[10px] font-bold text-gray-600 mt-2 mb-1 px-2 uppercase';
                    eraHeader.innerText = eras[t.era];
                    list.appendChild(eraHeader);
                    currentEra = t.era;
                }

                const btn = document.createElement('button');
                btn.className = `layer-btn w-full text-left px-3 py-2 text-xs font-mono text-gray-300 hover:bg-slate-800 transition border-l-0 border-transparent`;
                btn.style.borderColor = activeLayerIds.has(t.id) ? t.color : 'transparent';
                if (activeLayerIds.has(t.id)) {
                    btn.classList.add('bg-slate-800', 'active');
                }

                btn.innerHTML = `
                    <div class="flex items-center justify-between">
                        <span>${t.name}</span>
                        <div class="w-2 h-2 rounded-full" style="background-color: ${t.color}"></div>
                    </div>
                `;

                btn.onclick = () => {
                    if (isStoryMode) return; // Disable manual toggle in story mode
                    if (activeLayerIds.has(t.id)) activeLayerIds.delete(t.id);
                    else activeLayerIds.add(t.id);
                    renderLayerList(); // Re-render to update styles
                    updateChart();
                    generateInsight();
                };

                list.appendChild(btn);
            });
        }

        function renderStory() {
            const step = storySteps[currentStep];

            // Update Text
            document.getElementById('info-title').innerText = step.title;
            document.getElementById('info-content').innerHTML = `<p>${step.text}</p>`;
            document.getElementById('ai-insight').innerHTML = `<span class="text-yellow-400">>_ ANALYTICAL ENGINE:</span><br>${step.insight}`;

            // Update Pills
            const pillsContainer = document.getElementById('step-pills');
            pillsContainer.innerHTML = '';
            storySteps.forEach((_, idx) => {
                const pill = document.createElement('div');
                pill.className = `w-8 h-1 rounded-full bg-gray-700 ${idx === currentStep ? 'bg-blue-500' : ''}`;
                pillsContainer.appendChild(pill);
            });

            // Update Active Layers
            activeLayerIds = new Set(step.activeLayers);
            renderLayerList();
            updateChart();
        }

        function generateInsight() {
            const ids = Array.from(activeLayerIds);
            const content = document.getElementById('info-content');
            const insight = document.getElementById('ai-insight');

            if (ids.length === 0) {
                content.innerHTML = "<div class='text-gray-500 text-center mt-10'>í•™ìë¥¼ ì„ íƒí•˜ì—¬ ë¶„ì„ì„ ì‹œì‘í•˜ì‹­ì‹œì˜¤.</div>";
                insight.innerHTML = "ëŒ€ê¸° ì¤‘...";
                return;
            }

            if (ids.length === 1) {
                const t = theologians[ids[0]];
                content.innerHTML = `<h3 class="text-lg font-bold text-gray-200 mb-2">${t.name}</h3><p>${t.desc}</p>`;

                // Find highest axis
                let maxVal = -1;
                let maxIdx = -1;
                t.data.forEach((v, i) => { if (v > maxVal) { maxVal = v; maxIdx = i; } });

                insight.innerHTML = `>_ ì£¼ìš” íŠ¹ì§• ì‹ë³„:<br>ì´ í•™ìëŠ” <strong>'${axes[maxIdx]}'</strong> í•­ëª©ì—ì„œ ê°€ì¥ ë†’ì€ ìˆ˜ì¹˜(${maxVal})ë¥¼ ë³´ì…ë‹ˆë‹¤.`;
            } else {
                // Comparison Logic
                content.innerHTML = "<h3 class='text-md font-bold text-gray-300 mb-4'>ë¹„êµ ë¶„ì„ ëª¨ë“œ</h3>";
                ids.forEach(id => {
                    content.innerHTML += `<div class="mb-4 p-3 rounded-lg bg-slate-800/50 border-l-2" style="border-color:${theologians[id].color}"><strong class="text-base" style="color:${theologians[id].color}">${theologians[id].name}</strong><p class="mt-2 text-gray-300 text-sm leading-relaxed">${theologians[id].desc}</p></div>`;
                });

                // Calculate biggest difference
                let maxDiff = 0;
                let diffAxisIndex = 0;

                // Compare first two for simplicity or average
                const t1 = theologians[ids[0]];
                const t2 = theologians[ids[1]]; // Simple compare logic

                t1.data.forEach((v1, i) => {
                    const v2 = t2.data[i];
                    const diff = Math.abs(v1 - v2);
                    if (diff > maxDiff) {
                        maxDiff = diff;
                        diffAxisIndex = i;
                    }
                });

                insight.innerHTML = `>_ ì „ì„  ì¶©ëŒ ê°ì§€:<br>ë‘ ì§„ì˜ì€ <strong>'${axes[diffAxisIndex]}'</strong> ì¶•ì—ì„œ ê°€ì¥ ê·¹ëª…í•œ ì°¨ì´(${maxDiff}ì )ë¥¼ ë³´ì…ë‹ˆë‹¤. ì´ê²ƒì´ ë…¼ìŸì˜ í•µì…ë‹ˆë‹¤.`;
            }
        }

        // --- Event Listeners ---
        document.getElementById('mode-toggle').onclick = () => {
            isStoryMode = !isStoryMode;
            const btn = document.getElementById('mode-toggle');
            const indicator = document.getElementById('mode-indicator');
            const controls = document.getElementById('story-controls');

            if (isStoryMode) {
                btn.innerText = "SWITCH TO COMPARE";
                indicator.innerText = "STORY MODE ACTIVE";
                controls.style.display = 'flex';
                currentStep = 0;
                renderStory();
            } else {
                btn.innerText = "BACK TO STORY";
                indicator.innerText = "COMPARE MODE ACTIVE";
                controls.style.display = 'none';
                activeLayerIds.clear();
                renderLayerList();
                updateChart();
                generateInsight();
            }
        };

        document.getElementById('next-btn').onclick = () => {
            if (currentStep < storySteps.length - 1) {
                currentStep++;
                renderStory();
            }
        };

        document.getElementById('prev-btn').onclick = () => {
            if (currentStep > 0) {
                currentStep--;
                renderStory();
            }
        };

        // --- Init ---
        initChart();
        renderStory(); // Start in Story Mode

    </script>
</body>

</html>